datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL") // Důležité pro Supabase migrace
}

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

// --- 1. AKTUALITY (Blog) ---
model Post {
  id            String   @id @default(cuid())
  slug          String   @unique // URL adresa článku (např. "vanocni-vecirek-2024")
  title         String
  excerpt       String   // Krátký úvod (perex)
  content       String   // Hlavní text (Markdown)
  coverImageUrl String?  // Úvodní obrázek
  isFeatured    Boolean  @default(false) // "Top článek" na úvodní stránce
  publishedAt   DateTime @default(now())
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@index([slug])
}

// --- 2. VÝSLEDKY A SEZÓNY ---
model Season {
  id        String   @id @default(cuid())
  code      String   @unique // Např. "2023-2024"
  name      String   // Např. "Sezóna 2023/2024"
  startDate DateTime
  endDate   DateTime
  results   Result[]
}

model Result {
  id        String   @id @default(cuid())
  date      DateTime
  venue     String   // Místo konání (např. "Hospoda U Lípy")
  teamName  String   // Název týmu (pro případ, že hrajeme pod jiným jménem)
  placement Int      // Umístění (1, 2, 3...)
  score     Int      // Počet bodů
  note      String?  // Poznámka
  seasonId  String
  season    Season   @relation(fields: [seasonId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([seasonId, date])
}

// --- 3. TÝM (Členové) ---
model Member {
  id          String   @id @default(cuid())
  displayName String   // Jméno zobrazované na webu
  nickname    String?  // Přezdívka
  gender      Gender   @default(MALE)
  role        String?  // Např. "Kapitán", "Hudební expert"
  specialties String[] // Co mu jde (zatím nepoužíváme, ale v DB může zůstat)
  bio         String?  // Krátký popisek o členovi
  avatarUrl   String?  // Fotka
  isActive    Boolean  @default(true) // Jestli je stále členem
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

enum Gender {
  MALE
  FEMALE
}

// --- 4. GALERIE ---
model Album {
  id               String   @id @default(cuid())
  title            String
  description      String?  // Popis alba (např. "Fotky z našeho vítězství")
  dateTaken        DateTime // Datum akce
  cloudinaryFolder String   // Složka na Cloudinary (např. "jaro-2024")
  coverPublicId    String?  // ID fotky, která bude na obálce alba
  photos           Photo[]
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
}

model Photo {
  id                 String   @id @default(cuid())
  cloudinaryPublicId String   // ID obrázku na Cloudinary
  caption            String?  // Popisek fotky
  sortOrder          Int      @default(0) // Pro řazení fotek (volitelné)
  albumId            String
  album              Album    @relation(fields: [albumId], references: [id], onDelete: Cascade)
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  @@index([albumId])
}

// --- 5. PLAYLISTY ---
model Playlist {
  id          String   @id @default(cuid())
  title       String
  description String?  // Krátký popis (max 200 znaků)
  spotifyUrl  String   // Zde uložíme čisté URL (src z iframe)
  isActive    Boolean  @default(false) // Který playlist zrovna hraje na webu
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}